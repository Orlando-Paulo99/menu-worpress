/* incluindo o link para o cliente finalizar a compra pelo whatsapp*/
add_action('wp_footer', function() { ?>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const checkoutButton = document.querySelector('.woocommerce a.checkout-button');

            if (checkoutButton) {
                checkoutButton.addEventListener('click', function (event) {
                    event.preventDefault(); // Impede a finalizaÃ§Ã£o padrÃ£o

                    // NÃºmero do WhatsApp (adicione o DDD sem espaÃ§o ou caracteres especiais)
                    const numeroWhatsapp = "5522992590656";

                    // Coleta os itens do carrinho e gera a mensagem
                    let mensagem = "OlÃ¡! Quero finalizar minha compra com os seguintes itens:%0A";
                    document.querySelectorAll('.woocommerce-cart-form__cart-item').forEach(item => {
                        const nomeProduto = item.querySelector('.product-name a')?.innerText || "Produto";
                        const quantidade = item.querySelector('.product-quantity input')?.value || "1";
                        mensagem += `ðŸ›’ ${quantidade}x ${nomeProduto}%0A`;
                    });

                    mensagem += "%0AðŸš€ Vamos finalizar o pedido?";
                    
                    // Monta a URL do WhatsApp
                    const urlWhatsApp = `https://wa.me/${numeroWhatsapp}?text=${mensagem}`;
                    
                    // Redireciona para o WhatsApp
                    window.location.href = urlWhatsApp;
                });
            }
        });
    </script>
<?php });
